main()
{
        curdir=`pwd`
        dllmachine_name=$1
        zipname=$2
        batname=$3
        unzipdir=$4
        basedir=${unzipdir}/..

        mkdir -p $unzipdir
        unzip -o $zipname -d $unzipdir
        cd $unzipdir
        a=`find -iname "*.bat"`
        for i in $a
        do
            grepval=`grep -ir "call " $i | grep -iEv "signing_*|_sign|%CURRENT_DIR%|%OUTPUT_DIR%|%WDIR%|.zip|.out|%LOCAL_CLASSPATH%i|%SERVER_HOME%|setCommonEnv.bat" | awk -F " " '{$1="";print}' | sed 's/^ //g' | sed 's/\"//g'`
            if [ "${grepval}" != "" ]
            then
                    echo "$grepval@${dllmachine_name}," >> ${basedir}/winpack_details_all.txt

            fi
            #echo $grepval
        done
        sed -i '/^$/d' ${basedir}/winpack_details_all.txt
        cd -

}

main $*
