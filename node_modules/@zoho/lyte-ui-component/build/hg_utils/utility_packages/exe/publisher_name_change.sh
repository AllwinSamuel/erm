main()
{
	if [ -d ${1} ]
	then
		replace_publisherEntry $1 "COMPANY_NAME"
		replace_publisherEntry $1 "Manufacturer"
	else
		echo "$1 folder not available to change publisher name in installshield.."
	fi
}
replace_publisherEntry()
{
	project_folder_path=$1
	publisher_string_var=$2
	pattern="^[-_0-9A-Za-z. ]+$"
	matched_project_path=$(grep -rl "<td>${publisher_string_var}</td>" ${project_folder_path})

	if [ "${matched_project_path}" != "" ]
	then
		for project_path in $(echo $matched_project_path)
		do
			projectname=$(basename ${project_path})
			project_extension=$(echo "${projectname##*.}")
			if [ -f ${project_path} -a "${project_extension}" = "ism" ]
			then
			    echo "------ Matched project path[${publisher_string_var}]: $project_path ------"
			    grep -rn "<td>${publisher_string_var}</td>" ${project_path} | while read -r line;
		            do
			        string_path_lineno=$(echo ${line} | cut -d ":" -f1)
			        string_path=$(echo ${line} | cut -d ":" -f2)

			        if [ "${publisher_string_var}" = "COMPANY_NAME" ]
			        then
			            existing_company_name=$(echo ${string_path} | awk -F'</*td>' '$6{print $6}')
			        else
			            existing_company_name=$(echo ${string_path} | awk -F'</*td>' '$4{print $4}')
			        fi

			        if [ "${existing_company_name}" != "" -a "${existing_company_name}" != "Zoho Corporation Pvt. Ltd." ]
			        then
				    echo "${existing_company_name}" | grep -Eq "$pattern"
				    if [ $? -eq 0 ]
				    then
			                sed -i "${string_path_lineno}s/${existing_company_name}/Zoho Corporation Pvt. Ltd./" ${project_path}
			                if [ $? -eq 0 ]
			                then
					    echo "------ Publisher name entry added in (LineNo: ${string_path_lineno}) : ${project_path} ------"
			                else
					    echo "------ Publisher name changes failed in (LineNo: ${string_path_lineno}): ${project_path} ------"
			                fi
				    else
					    echo "------ Publisher name changes ignored in (LineNo: ${string_path_lineno}): ${project_path} ------"
				     fi
		    	        fi
			    done
			    echo "------ Publisher Name Changes completed : $project_path --------\n"
			fi
		done
	fi
}
main $*
